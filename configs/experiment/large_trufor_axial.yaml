# @package _global_

defaults:
  - override /data: contact
  - override /model: esm2_t33_650M
  - override /callbacks: default
  - override /trainer: default
  - override /logger: neptune

task_name: "large_trufor_axial"

tags: ["contact-pred", "esm2_t33_650M", "trufor", "axial", "blosum", "tversky", "esm contacts"]
seed: 42


trainer:
  max_epochs: 50
  accumulate_grad_batches: 4

data:
  batch_size: 16
  crop_size: 512
  num_workers: 8
  bucketed: true

model:
  # contact prediction head
  d_pair: 256
  width: 256
  depth: 8

  # head architecture
  head_type: "axial"    # "cnn", "dilated", or "axial"
  head_num_heads: 8

  # trufor fusion parameters
  fusion_strategy: "trufor"
  fusion_num_heads: 16
  fusion_reduction: 1