# @package _global_

defaults:
  - override /data: contact
  - override /model: esm2_t6_8M
  - override /callbacks: default
  - override /trainer: default
  - override /logger: neptune

task_name: "trufor_axial"

tags: ["contact-pred", "esm2_t6_8M", "trufor", "axial", "blosum", "tversky", "esm contacts"]
seed: 42


trainer:
  max_epochs: 50
  accumulate_grad_batches: 4

data:
  batch_size: 8
  crop_size: 256
  num_workers: 2
  bucketed: true

model:
  # contact prediction head
  d_pair: 64
  width: 64
  depth: 4

  # head architecture
  head_type: "axial"    # "cnn", "dilated", or "axial"
  head_num_heads: 2

  # trufor fusion parameters
  fusion_strategy: "trufor"
  fusion_num_heads: 2
  fusion_reduction: 1